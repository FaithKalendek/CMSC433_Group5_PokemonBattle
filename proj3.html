<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Pokémon Battle</title>
  <link rel="stylesheet" href="proj3.css">
</head>
<body>

  <!-- Banner -->
  <header>
    <h1>Pokémon Battle</h1>
  </header>

  <!-- Intro/Identity Selection Screen. Story content helped developed by AI -->
  <section id="intro-screen">
    <div class="text-box intro-narrative">
      <h2>Welcome to the Indigo Training Program</h2>
      <p>
        You’ve officially joined the Indigo Training Program—an experimental new format for rookie trainers. 
        No travel. No gyms. Just back-to-back battles in a controlled environment designed to sharpen your instincts and test your adaptability.
      </p>
      <p>
        You’ll start with two Pokémon and face off against an opponent with two of their own. Each victory lets you capture one of their Pokémon to add to your team. 
        From there, battles get tougher—your team grows, but so does theirs.
      </p>
      <p>
        There’s no leveling, no items, and no second chances. Just you, your team, and a series of unpredictable matchups.
        Moves and opponents are randomized, so there's no one strategy that wins it all—you’ll have to adapt and make do with what you’ve got.
      </p>
      <p class="emphasis">
        Defeat all 10 opponents, and you'll graduate the program with top honors. Fail... and you'll start again from scratch.
      </p>
      <p class="question">
        So, what kind of trainer will you be?
      </p>
    </div>

    <!-- Identity Selection -->
    <div class="identity-selection">
      <h3 style="text-align:center;">Choose Your Identity</h3>
      <div class="identity-grid">
        <!-- Ambitious Rookie -->
        <div class="identity-card" data-identity="rookie">
          <img src="images/ambitiousrookie.png" alt="Ambitious Rookie">
          <h4>The Ambitious Rookie</h4>
          <div class="text-box">
            <p class="blurb">
              You're bold, driven, and hungry to prove yourself. The world of Pokémon is waiting—and you're not wasting any time.
            </p>
          </div>
          <button class="select-identity">Choose</button>
        </div>

        <!-- Curious Scholar -->
        <div class="identity-card" data-identity="scholar">
          <img src="images/curiousscholar.png" alt="Curious Scholar">
          <h4>The Curious Scholar</h4>
          <div class="text-box">
            <p class="blurb">
              You love knowing how things work—from Pokémon evolution to battle mechanics. It’s not just about strength; it’s about understanding.
            </p>
          </div>
          <button class="select-identity">Choose</button>
        </div>

        <!-- Wild Wanderer -->
        <div class="identity-card" data-identity="wanderer">
          <img src="images/wildwanderer.png" alt="Wild Wanderer">
          <h4>The Wild Wanderer</h4>
          <div class="text-box">
            <p class="blurb">
              You feel most at home outdoors, surrounded by nature. You and Pokémon? You’ve always spoken the same language.
            </p>
          </div>
          <button class="select-identity">Choose</button>
        </div>

        <!-- Joyful Beginner -->
        <div class="identity-card" data-identity="beginner">
          <img src="images/joyfulbeginner.png" alt="Joyful Beginner">
          <h4>The Joyful Beginner</h4>
          <div class="text-box">
            <p class="blurb">
              You’re just getting started, but your love for Pokémon is already shining bright. And that’s what really matters.
            </p>
          </div>
          <button class="select-identity">Choose</button>
        </div>
      </div>
    </div>

    <!-- Selected Identity Summary -->
    <div id="identity-summary" class="hidden text-box">
      <h3>You Chose:</h3>
      <img id="identity-summary-avatar" src="" alt="Your Trainer Avatar" style="width:100px;display:block;margin:auto;">
      <h4 id="identity-name">The Ambitious Rookie</h4>
      <p id="identity-snippet"></p>
      <button id="start-battle">Start Your Journey</button>
    </div>
  </section>

  <!-- Main Battle Screen -->
<main id="battle-screen" class="hidden">
  <!-- Player's Side -->
  <div class="trainer-side player-side">
    <img class="trainer-sprite" id="player-trainer-sprite" src="images/ambitiousrookie.png" alt="Player Trainer">
    <div class="trainer">
      <img id="player-avatar" src="images/charmander.gif" alt="Player Avatar">
      <h2 id="player-name-display">Player</h2>
      <div class="hp-bar"><div class="hp-fill" id="player-hp"></div></div>
    </div>
  </div>

  <!-- Opponent's Side -->
  <div class="trainer-side opponent-side">
    <div class="trainer">
      <img id="opponent-avatar" src="images/squirtle.gif" alt="Opponent Avatar">
      <h2>Opponent</h2>
      <div class="hp-bar"><div class="hp-fill" id="opponent-hp"></div></div>
    </div>
    <img class="trainer-sprite" id="opponent-trainer-sprite" src="images/youngster.png" alt="Opponent Trainer">
  </div>

  <!-- Move Buttons -->
  <section id="action-panel">
    <div class="tooltip">
      <button class="move-btn">Move 1</button>
      <pre class="tooltiptext"></pre>
    </div>
    <div class="tooltip">
      <button class="move-btn">Move 2</button>
      <pre class="tooltiptext"></pre>
    </div>
  </section>

  <!-- Status Updates -->
  <section id="status-box">
    <p>Welcome to Pokémon Battle!</p>
  </section>

  <!-- Pokémon Switch Panel -->
<section id="switch-panel" class="hidden">
  <h3>Switch Pokémon</h3>
  <div class="team-roster" id="team-roster">
    <!-- Pokémon buttons will be inserted here dynamically -->
  </div>
</section>

</main>
  
  <!-- Pokémon Selection Screen -->
  <section id="pokemon-selection" class="hidden">
    <div class="text-box">
      <h2>Victory!</h2>
      <p>You defeated your opponent! Choose one of their Pokémon to add to your team:</p>
    </div>

    <div id="selection-grid" class="selection-grid"></div>

    <div id="selection-confirmation" class="hidden text-box">
      <p id="selection-message"></p>
      <button id="next-battle">Continue to Next Battle</button>
    </div>
  </section>

  <!-- Final Victory Screen -->
<section id="victory-screen" class="hidden">
  <div class="text-box victory-box">
    <h2> Congratulations, Trainer!</h2>
    <p>You’ve conquered all 10 opponents and emerged victorious from the Indigo Training Program.</p>

    <div class="certificate">
      <h3>Certificate of Mastery</h3>
      <p>This certifies that</p>
      <h2 id="cert-name">[Trainer Title]</h2>
      <p>has successfully completed the Indigo Training Program and demonstrated exceptional strategic skill and adaptability in Pokémon battle.</p>
    </div>
    <button id="play-again">Play Again</button>
  </div>
</section>

<!-- Pre-Battle Dialogue Screen -->
<section id="pre-battle-screen" class="hidden">
  <div class="text-box prebattle-box">
    <img id="prebattle-sprite" src="" alt="Opponent Trainer" class="prebattle-sprite">
    <p id="prebattle-dialogue"></p>
    <button id="start-battle-btn">Begin Battle</button>
  </div>
</section>

<!-- Loss Screen -->
<section id="loss-screen" class="hidden">
  <div class="text-box loss-box">
    <h2>You Were Defeated...</h2>
    <p>The Indigo Training Program proved too tough this time. But every great trainer learns from failure.</p>

    <div class="certificate loss-certificate">
      <h3>Notice of Elimination</h3>
      <p>This certifies that</p>
      <h2 id="loss-name">[Player Name]</h2>
      <p>has shown courage and determination, but did not complete the Indigo Training Program.</p>
      <p>Keep training, and return stronger next time!</p>
    </div>

    <button id="play-again-loss">Try Again</button>
  </div>
</section>

  <!-- JavaScript -->
  <script>
    // Identity story blurbs for each trainer
    const identitySnippets = {
      rookie: "You’ve always wanted more than a quiet life in a small town. Watching championship matches lit a fire in you that never went out. Now you’ve enrolled in the Indigo Training Program, determined to stand out from the crowd. You won’t just be another rookie—you’ll be the one they remember.",
      scholar: "Your bookshelf is lined with Pokédexes and field notes. You’ve spent years studying how Pokémon behave, how trainers think, and what makes a strategy stick. Now it's time to apply that knowledge in real battle conditions. The Training Program is your first live experiment—and you're ready to learn everything.",
      wanderer: "Raised among forests and rivers, Pokémon were your childhood playmates before they were ever called “partners.” The Training Program is your first step into a more structured journey—but you haven’t forgotten your roots. You're here to prove that instinct, heart, and harmony still have a place in battle.",
      beginner: "Some people say beginners are easy to beat. Let them. You’re not here to impress anyone—you’re here to learn, to grow, and to enjoy every moment alongside your Pokémon. The Training Program may be tough, but your excitement is unstoppable. Even your opponents can’t help but smile when you enter the arena."
    };

    // Avatar lookup for summary
    const playerAvatarMap = {
      rookie: "images/ambitiousrookie.png",
      scholar: "images/curiousscholar.png",
      wanderer: "images/wildwanderer.png",
      beginner: "images/joyfulbeginner.png"
    };

    // For chosen identity display
    const identityDisplayNames = {
      rookie: "Ambitious Rookie",
      scholar: "Curious Scholar",
      wanderer: "Wild Wanderer",
      beginner: "Joyful Beginner"
    };

    const opponents = [
      { name: "Youngster Joey",  sprite: "images/youngster.png"  },
      { name: "Lass Ellie",      sprite: "images/lass.png" },
      { name: "PokéManiac Brent",sprite: "images/pokemaniac.png" },
      { name: "Ace Trainer Chad",sprite: "images/acetrainerchad.png" },
      { name: "Ace Trainer Quinn",sprite:"images/acetrainerquinn.png" },
      { name: "Lt. Surge",       sprite: "images/ltsurge.png" },
      { name: "Team Rocket",     sprite: "images/teamrocket.png"},
      { name: "Gym Leader Misty",sprite: "images/misty.png" },
      { name: "Gym Leader Brock",sprite: "images/brock.png" },
      { name: "Champion Blue",   sprite: "images/championblue.png" }
    ];
    let currentOpponent = 0;

    // Choosing identity
    document.querySelectorAll('.select-identity').forEach(button => {
      button.addEventListener('click', () => {
        const card = button.closest('.identity-card');
        const identityKey = card.dataset.identity;
        const identityName = card.querySelector('h4').textContent.slice(4).toLocaleLowerCase().replace(/\s+/g,""); 

        document.getElementById('identity-name').textContent = identityDisplayNames[identityKey] || identityKey;
        document.getElementById('identity-snippet').textContent = identitySnippets[identityKey];

        // Set the avatar image in the summary
        const avatarImg = document.getElementById('identity-summary-avatar');
        avatarImg.src = playerAvatarMap[identityKey] || "images/default_player.png";
        avatarImg.alt = identityDisplayNames[identityKey] + " Avatar";

        // Store the full URL for use in ui.js
        window.selectedAvatarUrl = playerAvatarMap[identityKey] || "images/default_player.png";

        document.querySelector('.identity-selection').style.display = 'none';
        document.getElementById('identity-summary').classList.remove('hidden');
        window.selectedIdentity = identityKey;
      });
    });
    
    // Go to battle screen
    document.getElementById('start-battle').addEventListener('click', () => {
      document.getElementById('intro-screen').classList.add('hidden');
      // Save the selected avatar URL globally for ui.js to use
      window.selectedAvatarUrl = window.selectedAvatarUrl || "images/ambitiousrookie.png";
      showPreBattleScreen(opponents[0].name, opponents[0].sprite);
    });

    const defeatedPokemon = [
      { name: "Zubat", sprite: "proj3_images/1st Generation/041Zubat.png" },
      { name: "Oddish", sprite: "proj3_images/1st Generation/043Oddish.png" },
      { name: "Diglett", sprite: "proj3_images/1st Generation/050Diglett.png" }
    ];

    // Selection Screen. Choosing Pokemon from defeated trainer
    function showPokemonSelectionScreen() {
      document.getElementById('battle-screen').classList.add('hidden');
      document.getElementById('pokemon-selection').classList.remove('hidden');

      const grid = document.getElementById('selection-grid');
      grid.innerHTML = '';

      defeatedPokemon.forEach(p => {
        const card = document.createElement('div');
        card.className = 'pokemon-card';
        card.dataset.name = p.name;

        card.innerHTML = `
          <img src="${p.sprite}" alt="${p.name}">
          <h4>${p.name}</h4>
          <button class="select-pokemon">Choose</button>
        `;

        grid.appendChild(card);
      });

      document.querySelectorAll('.select-pokemon').forEach(btn => {
        btn.addEventListener('click', () => {
          const chosen = btn.closest('.pokemon-card').dataset.name;
          document.getElementById('selection-message').textContent = `You chose ${chosen}! Great choice.`;
          document.getElementById('selection-confirmation').classList.remove('hidden');
        });
      });
    }

    // Go to next battle
    document.getElementById('next-battle').addEventListener('click', () => {
      document.getElementById('pokemon-selection').classList.add('hidden');
      document.getElementById('selection-confirmation').classList.add('hidden');
      currentOpponent++;

      if (currentOpponent >= opponents.length) {
        showVictoryScreen();
      } else {
        showPreBattleScreen(
          opponents[currentOpponent].name,
          opponents[currentOpponent].sprite
        );
      }
    });

    function showVictoryScreen() {
      // Hide other game sections
      document.getElementById('battle-screen').classList.add('hidden');
      document.getElementById('pokemon-selection').classList.add('hidden');
      document.getElementById('switch-panel').classList.add('hidden');

      // Set certificate identity title (e.g., "The Curious Scholar")
      const identity = document.getElementById('identity-name').textContent;
      document.getElementById('cert-name').textContent = identity;

      // Show the final victory screen
      document.getElementById('victory-screen').classList.remove('hidden');
    }

    // Play Again button — reloads the page
    document.getElementById('play-again').addEventListener('click', () => {location.reload();
    });

    function showLossScreen() {
      // Hide other screens
      document.getElementById('battle-screen').classList.add('hidden');
      document.getElementById('pokemon-selection').classList.add('hidden');
      document.getElementById('switch-panel').classList.add('hidden');
      document.getElementById('pre-battle-screen').classList.add('hidden');

      // Use selected identity title for the certificate
      const identity = document.getElementById('identity-name').textContent;
      document.getElementById('loss-name').textContent = identity;

      // Show loss screen
      document.getElementById('loss-screen').classList.remove('hidden');
    }
    
    document.getElementById('play-again-loss').addEventListener('click', () => {location.reload();
    });

    // Map pre-battle dialogue based on opponent name
    const trainerDialogue = {
      "Youngster Joey": "Whoa! You’re new too? Awesome! Let’s see who’s got the better starter skills!",
      "Lass Ellie": "Ooo, you’ve already beaten a few people? I like your vibe. Let’s make this fun!",
      "PokéManiac Brent": "So you’ve survived the easy battles. Things are about to get... weird.",
      "Ace Trainer Chad": "Not bad, rookie. Most people don’t get this far. Think you’ve got what it takes?",
      "Ace Trainer Quinn": "You’ve shown some real promise. But this is where the real competitors shine.",
      "Lt. Surge": "You’ve got spark, kid—but let’s see if you’ve got the voltage to back it up!",
      "Team Rocket": "You’ve been steamrolling everyone, huh? Well prepare for trouble—and make it double!",
      "Gym Leader Misty": "You’ve made it far, but this is where most beginners wash out. Ready for a real test?",
      "Gym Leader Brock": "I’ve watched your battles. You’ve grown stronger—but strength without control means nothing.",
      "Champion Blue": "9 wins, huh? Not bad for a newbie. But if you want to graduate, you’ll have to beat the best."
    };

    // Show pre-battle dialogue screen
    function showPreBattleScreen(opponentName, spritePath) {
      // Set sprite and dialogue
      document.getElementById('prebattle-sprite').src = spritePath;
      document.getElementById('prebattle-sprite').alt = opponentName;
      document.getElementById('prebattle-dialogue').textContent = trainerDialogue[opponentName] || "Ready for battle.";

      // Hide everything else
      document.getElementById('intro-screen')?.classList.add('hidden');
      document.getElementById('battle-screen').classList.add('hidden');
      document.getElementById('victory-screen')?.classList.add('hidden');
      document.getElementById('pokemon-selection').classList.add('hidden');

      // Show dialogue screen
      document.getElementById('pre-battle-screen').classList.remove('hidden');
    }

    // Hook up the "Begin Battle" button
    document.getElementById('start-battle-btn').addEventListener('click', () => {
      document.getElementById('pre-battle-screen').classList.add('hidden');
      document.getElementById('battle-screen').classList.remove('hidden');
    });

    // const moves = [
    //   { name: "Growl", desc: "The user growls...", power: null, accuracy: 100 },
    //   { name: "Ember", desc: "Shoots a flame...", power: 40, accuracy: 100 }
    // ];

    // document.querySelectorAll('.tooltip').forEach((tooltipDiv, index) => {
    //   const span = tooltipDiv.querySelector('.tooltiptext');
    //   const move = moves[index];
    //   span.textContent = `${move.name}: ${move.desc} Power: ${move.power ?? '—'}, Accuracy: ${move.accuracy}%`;
    // });

  </script>
<script type="module" src="ui.js"></script>
</body>
</html>
